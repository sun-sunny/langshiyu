function getCityList(e){var t=urlSearch();$.ajax({type:"get",url:t+"/system/rest/projects/getProjectInfoWithArea",datatype:"json",cache:!1,success:function(t){for(var i=0;i<t.length;i++){if(e.indexOf(t[i].code)>=0)var o='<option value="'+t[i].code+'" selected>'+t[i].code_desc_zh+"</option>";else var o='<option value="'+t[i].code+'">'+t[i].code_desc_zh+"</option>";0!==t[i].prjCount&&$("#city").append(o),$("#city").mobiscroll().select({minWidth:200})}},error:function(e){tip("error",e.MSG)}})}function getProjectList(e,t){var i=urlSearch(),o={areaCode:e};$.ajax({type:"POST",contentType:"application/json",url:i+"/system/rest/projects/getProjectListForFront",datatype:"json",cache:!1,data:JSON.stringify(o),success:function(e){for(var i="",o=0;o<e.projects.length;o++){if(t.indexOf(e.projects[o].prjId)>=0)var i='<option value="'+e.projects[o].prjId+'" selected>'+e.projects[o].prjName+"</option>";else var i='<option value="'+e.projects[o].prjId+'">'+e.projects[o].prjName+"</option>";$("#project").append(i),$("#project").mobiscroll().select({minWidth:200})}},error:function(e){tip("error",e.MSG)}})}function getCode(e){var t=$("#name").val(),i=$("#sex").val(),o=t+","+i,n=this.getNowFormatDate(),r=$("#phone").val()+n+"order",a=this.MD5(r),c={params:o,phone:$("#phone").val(),oper:"order",secretKey:a},s=urlSearch();$.ajax({type:"post",contentType:"application/json",url:s+"/system/rest/sendSms/getVerifyCode",datatype:"json",data:JSON.stringify(c),success:function(t){__form.countCode(e)},complete:function(){},error:function(e){"200"!=e[0].status&&new $.flavr({content:"获取验证码失败.",autoclose:!0,buttons:{close:{text:"确定"}},timeout:5e3})}})}function getNowFormatDate(){var e=new Date,t=e.getMonth()+1,i=e.getDate();t>=1&&9>=t&&(t="0"+t),i>=0&&9>=i&&(i="0"+i);var o=e.getFullYear()+t+i;return o}function rhex(e){for(str="",j=0;j<=3;j++)str+=hex_chr.charAt(e>>8*j+4&15)+hex_chr.charAt(e>>8*j&15);return str}function str2blks_MD5(e){for(nblk=(e.length+8>>6)+1,blks=new Array(16*nblk),i=0;i<16*nblk;i++)blks[i]=0;for(i=0;i<e.length;i++)blks[i>>2]|=e.charCodeAt(i)<<i%4*8;return blks[i>>2]|=128<<i%4*8,blks[16*nblk-2]=8*e.length,blks}function add(e,t){var i=(65535&e)+(65535&t),o=(e>>16)+(t>>16)+(i>>16);return o<<16|65535&i}function rol(e,t){return e<<t|e>>>32-t}function cmn(e,t,i,o,n,r){return add(rol(add(add(t,e),add(o,r)),n),i)}function ff(e,t,i,o,n,r,a){return cmn(t&i|~t&o,e,t,n,r,a)}function gg(e,t,i,o,n,r,a){return cmn(t&o|i&~o,e,t,n,r,a)}function hh(e,t,i,o,n,r,a){return cmn(t^i^o,e,t,n,r,a)}function ii(e,t,i,o,n,r,a){return cmn(i^(t|~o),e,t,n,r,a)}function MD5(e){x=str2blks_MD5(e);var t=1732584193,o=-271733879,n=-1732584194,r=271733878;for(i=0;i<x.length;i+=16){var a=t,c=o,s=n,l=r;t=ff(t,o,n,r,x[i+0],7,-680876936),r=ff(r,t,o,n,x[i+1],12,-389564586),n=ff(n,r,t,o,x[i+2],17,606105819),o=ff(o,n,r,t,x[i+3],22,-1044525330),t=ff(t,o,n,r,x[i+4],7,-176418897),r=ff(r,t,o,n,x[i+5],12,1200080426),n=ff(n,r,t,o,x[i+6],17,-1473231341),o=ff(o,n,r,t,x[i+7],22,-45705983),t=ff(t,o,n,r,x[i+8],7,1770035416),r=ff(r,t,o,n,x[i+9],12,-1958414417),n=ff(n,r,t,o,x[i+10],17,-42063),o=ff(o,n,r,t,x[i+11],22,-1990404162),t=ff(t,o,n,r,x[i+12],7,1804603682),r=ff(r,t,o,n,x[i+13],12,-40341101),n=ff(n,r,t,o,x[i+14],17,-1502002290),o=ff(o,n,r,t,x[i+15],22,1236535329),t=gg(t,o,n,r,x[i+1],5,-165796510),r=gg(r,t,o,n,x[i+6],9,-1069501632),n=gg(n,r,t,o,x[i+11],14,643717713),o=gg(o,n,r,t,x[i+0],20,-373897302),t=gg(t,o,n,r,x[i+5],5,-701558691),r=gg(r,t,o,n,x[i+10],9,38016083),n=gg(n,r,t,o,x[i+15],14,-660478335),o=gg(o,n,r,t,x[i+4],20,-405537848),t=gg(t,o,n,r,x[i+9],5,568446438),r=gg(r,t,o,n,x[i+14],9,-1019803690),n=gg(n,r,t,o,x[i+3],14,-187363961),o=gg(o,n,r,t,x[i+8],20,1163531501),t=gg(t,o,n,r,x[i+13],5,-1444681467),r=gg(r,t,o,n,x[i+2],9,-51403784),n=gg(n,r,t,o,x[i+7],14,1735328473),o=gg(o,n,r,t,x[i+12],20,-1926607734),t=hh(t,o,n,r,x[i+5],4,-378558),r=hh(r,t,o,n,x[i+8],11,-2022574463),n=hh(n,r,t,o,x[i+11],16,1839030562),o=hh(o,n,r,t,x[i+14],23,-35309556),t=hh(t,o,n,r,x[i+1],4,-1530992060),r=hh(r,t,o,n,x[i+4],11,1272893353),n=hh(n,r,t,o,x[i+7],16,-155497632),o=hh(o,n,r,t,x[i+10],23,-1094730640),t=hh(t,o,n,r,x[i+13],4,681279174),r=hh(r,t,o,n,x[i+0],11,-358537222),n=hh(n,r,t,o,x[i+3],16,-722521979),o=hh(o,n,r,t,x[i+6],23,76029189),t=hh(t,o,n,r,x[i+9],4,-640364487),r=hh(r,t,o,n,x[i+12],11,-421815835),n=hh(n,r,t,o,x[i+15],16,530742520),o=hh(o,n,r,t,x[i+2],23,-995338651),t=ii(t,o,n,r,x[i+0],6,-198630844),r=ii(r,t,o,n,x[i+7],10,1126891415),n=ii(n,r,t,o,x[i+14],15,-1416354905),o=ii(o,n,r,t,x[i+5],21,-57434055),t=ii(t,o,n,r,x[i+12],6,1700485571),r=ii(r,t,o,n,x[i+3],10,-1894986606),n=ii(n,r,t,o,x[i+10],15,-1051523),o=ii(o,n,r,t,x[i+1],21,-2054922799),t=ii(t,o,n,r,x[i+8],6,1873313359),r=ii(r,t,o,n,x[i+15],10,-30611744),n=ii(n,r,t,o,x[i+6],15,-1560198380),o=ii(o,n,r,t,x[i+13],21,1309151649),t=ii(t,o,n,r,x[i+4],6,-145523070),r=ii(r,t,o,n,x[i+11],10,-1120210379),n=ii(n,r,t,o,x[i+2],15,718787259),o=ii(o,n,r,t,x[i+9],21,-343485551),t=add(t,a),o=add(o,c),n=add(n,s),r=add(r,l)}return rhex(t)+rhex(o)+rhex(n)+rhex(r)}$(function(){!function(){getCityList(getCity_ProjectCode()[1]),mobiscroll.settings={theme:localStorage.theme,lang:"zh",display:"bottom",dateFormat:"yy-mm-dd",setText:"",cancelText:"",onItemTap:function(e,t){$(".mbsc-fr-btn0.mbsc-fr-btn-e.mbsc-fr-btn").click()}},$("#project option").remove(),getProjectList(getCity_ProjectCode()[1],getCity_ProjectCode()[0])}()}),$(document).on("change","#city",function(){$("#project option").remove(),getProjectList($("#city option:selected").val(),"choose")}),$(document).on("click",".icon-triange-right",function(){$(this).siblings("input").trigger("click")}),$(document).on("click","form .btn.code",function(){var e=$(this);__validate.isPhone($("input[name='phone']"))&&__validate.isNull($("input[name='name']"))&&getCode(e)}),$(document).on("click",".booking",function(){if($(".booking").attr("disabled","true"),__validate.isName($("input[name='name']"))){var e=document.getElementById("project"),t=e.selectedIndex,i=e.options[t].value,o=e.options[t].text,n=document.getElementById("city"),r=n.selectedIndex,a=n.options[r].value,c="_WJ2";"AREA1"==a&&(c="_WJ2"),"AREA2"==a&&(c="_WJ3"),"AREA3"==a&&(c="_WJ1");var s=$("#time").val(),l=s.toString();if("AREA0"===a)new $.flavr({content:"请选择城市",autoclose:!0,buttons:{close:{text:"确定"}},timeout:5e3});else if("请选择"===o)new $.flavr({content:"请选择项目",autoclose:!0,buttons:{close:{text:"确定"}},timeout:5e3});else if(__validate.isPhone($("input[name='phone']"))&&__validate.isNull($("input[name='name']"))&&__validate.isNull($("input[name='code']"))){var d={orderPersonName:$("#name").val(),orderPersonSex:$("#sex").val(),orderPersonTel:$("#phone").val(),orderTime:l,address:a,prjId:i,prjName:o,roomTypeCode:"_LRD1",roomTypeName:"一室一厅",verificationCode:$("#code").val()},f=urlSearch();$.ajax({type:"post",contentType:"application/json",url:f+"/system/rest/order/createOrder",datatype:"json",data:JSON.stringify(d),beforeSend:function(){},success:function(e){var t=e.id;null!=e.id?new $.flavr({animateEntrance:"fadeInDown",animateClosing:"fadeOutDown",content:"<span>预约成功<br />您的意见很重要，是否填写问卷？</span>",buttons:{close:{text:"残忍拒绝",style:"grey",action:function(){window.history.back()}},think:{text:"填写",action:function(){window.location.href="questionnaire.html?cityCode="+c+"&orderId="+t+"&prjName="+o+"&prjId="+i}}}}):($(".booking").removeAttr("disabled"),new $.flavr({content:e.MSG,autoclose:!0,buttons:{close:{text:"确定"}},timeout:5e3}))},complete:function(){},error:function(){}})}}});var hex_chr="0123456789abcdef";